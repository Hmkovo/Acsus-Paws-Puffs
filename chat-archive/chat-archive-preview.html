<!--
  èŠå¤©è®°å½•ç®¡ç†ä¸­å¿ƒ - è§†è§‰é¢„è§ˆé¡µé¢ v2
  ç‹¬ç«‹äºæ‰‹æœºåŠŸèƒ½ï¼Œä½†è§†è§‰é£æ ¼ç›¸ä¼¼
-->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>èŠå¤©è®°å½•ç®¡ç†ä¸­å¿ƒ - é¢„è§ˆ</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --archive-primary: #0099ff;
      --archive-primary-dark: #0e7ab8;
      --archive-primary-light: #e6f4fb;
      --archive-bg-main: #f0f0f2;
      --archive-bg-white: #ffffff;
      --archive-bg-chat: #ededef;
      --archive-text-primary: #333333;
      --archive-text-secondary: #999999;
      --archive-text-tertiary: #666666;
      --archive-text-white: #ffffff;
      --archive-border: #ececec;
      --archive-danger: #ff4d4f;
      --archive-success: #4caf50;
      --archive-warning: #ffc107;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 16px;
      background: #333;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }

    .archive-container {
      width: 420px;
      height: 750px;
      background: var(--archive-bg-main);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      display: flex;
      flex-direction: column;
      position: relative;
    }

    /* é¡¶éƒ¨æ ‡é¢˜æ  */
    .archive-header {
      height: 3em;
      background: var(--archive-bg-white);
      display: flex;
      align-items: center;
      padding: 0 1em;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      flex-shrink: 0;
      z-index: 10;
    }

    .archive-header-back {
      width: 2em;
      height: 2em;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--archive-text-secondary);
      cursor: pointer;
    }

    .archive-header-back:hover { color: var(--archive-primary); }

    .archive-header-title {
      flex: 1;
      text-align: center;
      font-size: 1.1em;
      font-weight: 500;
      color: var(--archive-text-primary);
    }

    .archive-header-action {
      width: 2em;
      height: 2em;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--archive-text-secondary);
      cursor: pointer;
    }

    .archive-header-action:hover { color: var(--archive-primary); }

    /* å†…å®¹åŒºåŸŸ */
    .archive-content {
      flex: 1;
      overflow: hidden;
      position: relative;
    }

    /* åº•éƒ¨å¯¼èˆªæ  */
    .archive-nav {
      height: 3.5em;
      background: var(--archive-bg-white);
      display: flex;
      box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.05);
      flex-shrink: 0;
    }

    .archive-nav-item {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 0.2em;
      color: var(--archive-text-secondary);
      cursor: pointer;
      transition: color 0.2s;
    }

    .archive-nav-item:hover { color: var(--archive-text-tertiary); }
    .archive-nav-item.active { color: var(--archive-primary); }
    .archive-nav-item i { font-size: 1.2em; }
    .archive-nav-item span { font-size: 0.65em; }

    /* é¡µé¢é€šç”¨ */
    .archive-page {
      display: none;
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      flex-direction: column;
      background: var(--archive-bg-main);
    }

    .archive-page.active { display: flex; }

    /* ========== æœç´¢é¡µé¢ ========== */
    .search-bar {
      padding: 0.8em;
      background: var(--archive-bg-white);
    }

    .search-input-wrapper {
      display: flex;
      align-items: center;
      background: var(--archive-bg-main);
      border-radius: 1.5em;
      padding: 0.5em 1em;
      gap: 0.5em;
    }

    .search-input-wrapper i { color: var(--archive-text-secondary); }

    .search-input-wrapper input {
      flex: 1;
      border: none;
      background: transparent;
      outline: none;
      font-size: 0.9em;
      color: var(--archive-text-primary);
    }

    .search-results {
      flex: 1;
      overflow-y: auto;
      padding: 0.5em;
    }

    .search-result-item {
      background: var(--archive-bg-white);
      border-radius: 0.5em;
      padding: 0.8em;
      margin-bottom: 0.5em;
      cursor: pointer;
    }

    .search-result-item:hover { background: var(--archive-primary-light); }

    .search-result-header {
      display: flex;
      align-items: center;
      gap: 0.5em;
      margin-bottom: 0.5em;
    }

    .search-result-avatar {
      width: 2.5em;
      height: 2.5em;
      border-radius: 0.3em;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      overflow: hidden;
    }

    .search-result-meta { flex: 1; }

    .search-result-char-name {
      font-size: 0.9em;
      font-weight: 500;
      color: var(--archive-text-primary);
    }

    .search-result-chat-name {
      font-size: 0.75em;
      color: var(--archive-text-secondary);
    }

    .search-result-actions {
      display: flex;
      gap: 0.5em;
    }

    .search-result-action {
      width: 1.8em;
      height: 1.8em;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--archive-text-secondary);
      border-radius: 50%;
    }

    .search-result-action:hover {
      background: var(--archive-bg-main);
      color: var(--archive-primary);
    }

    .search-result-action.favorited { color: var(--archive-warning); }

    .search-result-content {
      font-size: 0.85em;
      color: var(--archive-text-tertiary);
      line-height: 1.5;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .search-result-content mark {
      background: var(--archive-warning);
      color: var(--archive-text-primary);
      padding: 0 0.2em;
      border-radius: 0.2em;
    }

    /* ========== æ”¶è—å¤¹é¡µé¢ ========== */
    .favorites-groups {
      flex: 1;
      overflow-y: auto;
    }

    .favorites-group {
      background: var(--archive-bg-white);
      margin-bottom: 0.5em;
    }

    .favorites-group-header {
      display: flex;
      align-items: center;
      padding: 0.8em 1em;
      cursor: pointer;
    }

    .favorites-group-header:hover { background: var(--archive-bg-main); }

    .favorites-group-arrow {
      width: 1.5em;
      color: var(--archive-text-secondary);
      transition: transform 0.2s;
    }

    .favorites-group.collapsed .favorites-group-arrow { transform: rotate(-90deg); }

    .favorites-group-title {
      flex: 1;
      font-size: 0.95em;
      font-weight: 500;
      color: var(--archive-text-primary);
    }

    .favorites-group-count {
      font-size: 0.8em;
      color: var(--archive-text-secondary);
    }

    .favorites-group-items { border-top: 1px solid var(--archive-border); }
    .favorites-group.collapsed .favorites-group-items { display: none; }

    .favorites-item {
      display: flex;
      align-items: center;
      padding: 0.8em 1em;
      gap: 0.8em;
      cursor: pointer;
    }

    .favorites-item:hover { background: var(--archive-primary-light); }
    .favorites-item:not(:last-child) { border-bottom: 1px solid var(--archive-border); }

    .favorites-item-avatar {
      width: 3em;
      height: 3em;
      border-radius: 0.3em;
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      flex-shrink: 0;
      overflow: hidden;
    }

    .favorites-item-content {
      flex: 1;
      min-width: 0;
    }

    .favorites-item-title {
      font-size: 0.9em;
      font-weight: 500;
      color: var(--archive-text-primary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      display: flex;
      align-items: center;
      gap: 0.4em;
    }

    /* ç¬”è®°æ ‡è®° */
    .favorites-item-title .has-note {
      color: var(--archive-warning);
      font-size: 0.8em;
    }

    .favorites-item-preview {
      font-size: 0.8em;
      color: var(--archive-text-secondary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      margin-top: 0.2em;
    }

    .favorites-item-meta {
      font-size: 0.7em;
      color: var(--archive-text-secondary);
      margin-top: 0.2em;
    }

    .favorites-manage-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5em;
      padding: 0.8em;
      margin: 0.5em;
      background: var(--archive-bg-white);
      border-radius: 0.5em;
      color: var(--archive-text-secondary);
      cursor: pointer;
      font-size: 0.85em;
    }

    .favorites-manage-btn:hover {
      background: var(--archive-primary-light);
      color: var(--archive-primary);
    }

    .favorites-item.invalid { opacity: 0.5; }

    .favorites-item.invalid .favorites-item-title::after {
      content: ' (å·²å¤±æ•ˆ)';
      color: var(--archive-danger);
      font-size: 0.8em;
    }

    /* ========== ç¬”è®°é¡µé¢ ========== */
    .notes-filter {
      display: flex;
      gap: 0.5em;
      padding: 0.8em;
      background: var(--archive-bg-white);
      overflow-x: auto;
    }

    .notes-filter::-webkit-scrollbar { display: none; }

    .notes-filter-tag {
      padding: 0.4em 0.8em;
      background: var(--archive-bg-main);
      border-radius: 1em;
      font-size: 0.8em;
      color: var(--archive-text-secondary);
      cursor: pointer;
      white-space: nowrap;
      flex-shrink: 0;
    }

    .notes-filter-tag:hover { background: var(--archive-primary-light); }
    .notes-filter-tag.active {
      background: var(--archive-primary);
      color: var(--archive-text-white);
    }

    .notes-filter-tag.add-tag {
      border: 1px dashed var(--archive-border);
      background: transparent;
    }

    .notes-filter-tag.add-tag:hover {
      border-color: var(--archive-primary);
      color: var(--archive-primary);
    }

    .notes-list {
      flex: 1;
      overflow-y: auto;
      padding: 0.5em;
    }

    .note-item {
      background: var(--archive-bg-white);
      border-radius: 0.5em;
      padding: 0.8em;
      margin-bottom: 0.5em;
      cursor: pointer;
    }

    .note-item:hover { background: var(--archive-primary-light); }

    .note-item-header {
      display: flex;
      align-items: center;
      gap: 0.5em;
      margin-bottom: 0.5em;
    }

    .note-item-avatar {
      width: 2em;
      height: 2em;
      border-radius: 0.3em;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.8em;
    }

    .note-item-source {
      flex: 1;
    }

    .note-item-char {
      font-size: 0.85em;
      font-weight: 500;
      color: var(--archive-text-primary);
    }

    .note-item-chat {
      font-size: 0.7em;
      color: var(--archive-text-secondary);
    }

    .note-item-tags {
      display: flex;
      gap: 0.3em;
    }

    .note-item-tag {
      padding: 0.2em 0.5em;
      background: var(--archive-primary-light);
      border-radius: 0.3em;
      font-size: 0.65em;
      color: var(--archive-primary);
    }

    .note-item-content {
      font-size: 0.85em;
      color: var(--archive-text-tertiary);
      line-height: 1.5;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
      background: var(--archive-bg-main);
      padding: 0.5em;
      border-radius: 0.3em;
      margin-bottom: 0.5em;
    }

    .note-item-preview {
      font-size: 0.8em;
      color: var(--archive-text-secondary);
      font-style: italic;
    }

    .note-item-preview::before { content: 'ğŸ“ '; }

    /* ========== é˜…è¯»æ¨¡å¼ - è§’è‰²åˆ—è¡¨é¡µ ========== */
    .reader-char-list {
      flex: 1;
      overflow-y: auto;
      padding: 0.5em;
    }

    .reader-char-search {
      padding: 0.8em;
      background: var(--archive-bg-white);
      margin-bottom: 0.5em;
      border-radius: 0.5em;
    }

    .reader-char-search input {
      width: 100%;
      padding: 0.6em 1em;
      border: none;
      background: var(--archive-bg-main);
      border-radius: 1.5em;
      font-size: 0.9em;
      outline: none;
    }

    .reader-char-item {
      display: flex;
      align-items: center;
      padding: 0.8em;
      background: var(--archive-bg-white);
      border-radius: 0.5em;
      margin-bottom: 0.5em;
      cursor: pointer;
      gap: 0.8em;
    }

    .reader-char-item:hover { background: var(--archive-primary-light); }

    .reader-char-avatar {
      width: 3.5em;
      height: 3.5em;
      border-radius: 0.5em;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      overflow: hidden;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .reader-char-info {
      flex: 1;
      min-width: 0;
    }

    .reader-char-name {
      font-size: 1em;
      font-weight: 500;
      color: var(--archive-text-primary);
    }

    .reader-char-stats {
      font-size: 0.8em;
      color: var(--archive-text-secondary);
      margin-top: 0.2em;
    }

    .reader-char-arrow { color: var(--archive-text-secondary); }

    /* ========== é˜…è¯»æ¨¡å¼ - èŠå¤©è®°å½•åˆ—è¡¨é¡µ ========== */
    .reader-chat-list {
      flex: 1;
      overflow-y: auto;
      padding: 0.5em;
    }

    .reader-chat-item {
      display: flex;
      align-items: center;
      padding: 0.8em;
      background: var(--archive-bg-white);
      border-radius: 0.5em;
      margin-bottom: 0.5em;
      cursor: pointer;
      gap: 0.8em;
    }

    .reader-chat-item:hover { background: var(--archive-primary-light); }

    .reader-chat-icon {
      width: 2.5em;
      height: 2.5em;
      background: var(--archive-primary-light);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--archive-primary);
      flex-shrink: 0;
    }

    .reader-chat-info {
      flex: 1;
      min-width: 0;
    }

    .reader-chat-name {
      font-size: 0.9em;
      color: var(--archive-text-primary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .reader-chat-meta {
      font-size: 0.75em;
      color: var(--archive-text-secondary);
      margin-top: 0.2em;
    }

    /* ========== é˜…è¯»æ¨¡å¼ - é˜…è¯»è§†å›¾ ========== */
    .reader-view {
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .reader-content {
      flex: 1;
      overflow-y: auto;
      padding: 1em;
      background: var(--archive-bg-white);
    }

    .reader-message { margin-bottom: 1.5em; }

    .reader-message-sender {
      font-size: 0.8em;
      color: var(--archive-primary);
      margin-bottom: 0.3em;
      font-weight: 500;
    }

    .reader-message-sender.user { color: var(--archive-success); }

    .reader-message-text {
      font-size: 0.95em;
      line-height: 1.8;
      color: var(--archive-text-primary);
    }

    .reader-message-divider {
      height: 1px;
      background: var(--archive-border);
      margin-top: 1em;
    }

    .reader-bottom-bar {
      background: var(--archive-bg-white);
      padding: 0.8em;
      box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.05);
    }

    .reader-progress {
      display: flex;
      align-items: center;
      gap: 0.8em;
      margin-bottom: 0.6em;
    }

    .reader-progress-bar {
      flex: 1;
      height: 4px;
      background: var(--archive-bg-main);
      border-radius: 2px;
      overflow: hidden;
    }

    .reader-progress-fill {
      width: 35%;
      height: 100%;
      background: var(--archive-primary);
      border-radius: 2px;
    }

    .reader-progress-text {
      font-size: 0.75em;
      color: var(--archive-text-secondary);
      white-space: nowrap;
    }

    .reader-controls {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .reader-control-group {
      display: flex;
      align-items: center;
      gap: 0.5em;
    }

    .reader-control-label {
      font-size: 0.8em;
      color: var(--archive-text-secondary);
    }

    .reader-control-input {
      width: 3.5em;
      padding: 0.4em;
      border: 1px solid var(--archive-border);
      border-radius: 0.3em;
      text-align: center;
      font-size: 0.85em;
    }

    .reader-control-btn {
      padding: 0.5em 1em;
      background: var(--archive-primary);
      color: var(--archive-text-white);
      border: none;
      border-radius: 0.3em;
      font-size: 0.85em;
      cursor: pointer;
    }

    .reader-control-btn:hover { background: var(--archive-primary-dark); }

    .reader-control-btn.secondary {
      background: var(--archive-bg-main);
      color: var(--archive-text-tertiary);
    }

    .reader-control-btn.secondary:hover { background: var(--archive-border); }

    /* ========== æ”¶è—è¯¦æƒ…é¡µ ========== */
    .favorite-detail {
      display: none;
      flex-direction: column;
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: var(--archive-bg-main);
      z-index: 20;
    }

    .favorite-detail.active { display: flex; }

    .favorite-detail-header {
      display: flex;
      align-items: center;
      padding: 0.8em;
      background: var(--archive-bg-white);
      gap: 0.5em;
    }

    .favorite-detail-back {
      width: 2em;
      height: 2em;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--archive-text-secondary);
      cursor: pointer;
    }

    .favorite-detail-title {
      flex: 1;
      font-size: 1em;
      font-weight: 500;
      color: var(--archive-text-primary);
    }

    .favorite-detail-actions {
      display: flex;
      gap: 0.5em;
    }

    .favorite-detail-action {
      width: 2em;
      height: 2em;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--archive-text-secondary);
      cursor: pointer;
    }

    .favorite-detail-action:hover { color: var(--archive-primary); }

    /* æ–°çš„ä¸Šä¸‹æ–‡æ§åˆ¶ - ä¸Šæ–¹åŠ è½½æ›´å¤š */
    .context-load-more {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5em;
      padding: 0.6em;
      background: var(--archive-bg-white);
      margin: 0.5em;
      border-radius: 0.5em;
      font-size: 0.8em;
      color: var(--archive-text-secondary);
      cursor: pointer;
    }

    .context-load-more:hover {
      background: var(--archive-primary-light);
      color: var(--archive-primary);
    }

    .context-load-more input {
      width: 3em;
      padding: 0.3em;
      border: 1px solid var(--archive-border);
      border-radius: 0.3em;
      text-align: center;
      font-size: 1em;
    }

    .context-load-more i { font-size: 1em; }

    .favorite-messages {
      flex: 1;
      overflow-y: auto;
      padding: 0 0.8em;
      background: var(--archive-bg-chat);
    }

    .favorite-message {
      display: flex;
      gap: 0.5em;
      margin-bottom: 1em;
    }

    .favorite-message.sent { flex-direction: row-reverse; }

    .favorite-message-avatar {
      width: 2.5em;
      height: 2.5em;
      border-radius: 0.3em;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      flex-shrink: 0;
    }

    .favorite-message.sent .favorite-message-avatar {
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    }

    .favorite-message-bubble {
      max-width: 70%;
      padding: 0.6em 0.8em;
      border-radius: 0.5em;
      font-size: 0.9em;
      line-height: 1.5;
      background: var(--archive-bg-white);
      color: var(--archive-text-primary);
    }

    .favorite-message.sent .favorite-message-bubble { background: #95ec69; }

    .favorite-message.highlighted .favorite-message-bubble {
      box-shadow: 0 0 0 2px var(--archive-primary);
    }

    .favorite-notes {
      background: var(--archive-bg-white);
      border-top: 1px solid var(--archive-border);
    }

    .favorite-notes-header {
      display: flex;
      align-items: center;
      padding: 0.6em 0.8em;
      cursor: pointer;
    }

    .favorite-notes-header i {
      margin-right: 0.5em;
      color: var(--archive-text-secondary);
    }

    .favorite-notes-header span {
      flex: 1;
      font-size: 0.85em;
      color: var(--archive-text-secondary);
    }

    .favorite-notes-content { padding: 0 0.8em 0.8em; }

    /* ç¬”è®°åˆ†ç±»é€‰æ‹© */
    .favorite-notes-tags {
      display: flex;
      gap: 0.4em;
      margin-bottom: 0.5em;
      flex-wrap: wrap;
    }

    .favorite-notes-tag {
      padding: 0.3em 0.6em;
      background: var(--archive-bg-main);
      border-radius: 0.3em;
      font-size: 0.75em;
      color: var(--archive-text-secondary);
      cursor: pointer;
    }

    .favorite-notes-tag:hover { background: var(--archive-primary-light); }

    .favorite-notes-tag.active {
      background: var(--archive-primary);
      color: var(--archive-text-white);
    }

    .favorite-notes-tag.add-tag {
      border: 1px dashed var(--archive-border);
      background: transparent;
    }

    .favorite-notes-textarea {
      width: 100%;
      min-height: 4em;
      padding: 0.5em;
      border: 1px solid var(--archive-border);
      border-radius: 0.3em;
      font-size: 0.85em;
      resize: vertical;
      font-family: inherit;
    }
  </style>
</head>
<body>
  <div class="archive-container">
    <div class="archive-header">
      <div class="archive-header-back">
        <i class="fa-solid fa-chevron-left"></i>
      </div>
      <div class="archive-header-title">èŠå¤©è®°å½•ç®¡ç†</div>
      <div class="archive-header-action">
        <i class="fa-solid fa-ellipsis-vertical"></i>
      </div>
    </div>

    <div class="archive-content">

      <!-- ========== æœç´¢é¡µé¢ ========== -->
      <div class="archive-page active" id="page-search">
        <div class="search-bar">
          <div class="search-input-wrapper">
            <i class="fa-solid fa-magnifying-glass"></i>
            <input type="text" placeholder="æœç´¢æ‰€æœ‰èŠå¤©è®°å½•..." value="ä½ å¥½">
          </div>
        </div>
        <div class="search-results">
          <div class="search-result-item">
            <div class="search-result-header">
              <div class="search-result-avatar">
                <i class="fa-solid fa-user"></i>
              </div>
              <div class="search-result-meta">
                <div class="search-result-char-name">ç‚¼ç‹±æå¯¿éƒ</div>
                <div class="search-result-chat-name">2025-12-12 @20h 53m</div>
              </div>
              <div class="search-result-actions">
                <div class="search-result-action" title="æ”¶è—"><i class="fa-regular fa-star"></i></div>
                <div class="search-result-action" title="è·³è½¬"><i class="fa-solid fa-arrow-up-right-from-square"></i></div>
              </div>
            </div>
            <div class="search-result-content">ã€Œ<mark>ä½ å¥½</mark>å•Šï¼ä»Šå¤©çš„å¤©æ°”çœŸä¸é”™ï¼Œè¦ä¸è¦ä¸€èµ·å»ä¿®ç‚¼ï¼Ÿã€</div>
          </div>
          <div class="search-result-item">
            <div class="search-result-header">
              <div class="search-result-avatar" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                <i class="fa-solid fa-cat"></i>
              </div>
              <div class="search-result-meta">
                <div class="search-result-char-name">çŒ«å¨˜å°é›ª</div>
                <div class="search-result-chat-name">2025-12-10 @15h 22m</div>
              </div>
              <div class="search-result-actions">
                <div class="search-result-action favorited" title="å·²æ”¶è—"><i class="fa-solid fa-star"></i></div>
                <div class="search-result-action" title="è·³è½¬"><i class="fa-solid fa-arrow-up-right-from-square"></i></div>
              </div>
            </div>
            <div class="search-result-content">ã€Œå–µï½ä¸»äºº<mark>ä½ å¥½</mark>å‘€ï¼ä»Šå¤©æƒ³è¦å°é›ªé™ªä½ åšä»€ä¹ˆå‘¢ï¼Ÿã€</div>
          </div>
        </div>
      </div>

      <!-- ========== æ”¶è—å¤¹é¡µé¢ ========== -->
      <div class="archive-page" id="page-favorites">
        <div class="favorites-groups">
          <div class="favorites-group">
            <div class="favorites-group-header">
              <i class="fa-solid fa-caret-down favorites-group-arrow"></i>
              <div class="favorites-group-title">é»˜è®¤æ”¶è—</div>
              <div class="favorites-group-count">3</div>
            </div>
            <div class="favorites-group-items">
              <div class="favorites-item">
                <div class="favorites-item-avatar"><i class="fa-solid fa-user"></i></div>
                <div class="favorites-item-content">
                  <div class="favorites-item-title">
                    æå¯¿éƒçš„ç»å…¸å°è¯
                    <i class="fa-solid fa-note-sticky has-note" title="æœ‰ç¬”è®°"></i>
                  </div>
                  <div class="favorites-item-preview">ã€Œå¿ƒã‚’ç‡ƒã‚„ã›ï¼ã€â€”â€”ç‡ƒçƒ§ä½ çš„å¿ƒå§ï¼</div>
                  <div class="favorites-item-meta">ç‚¼ç‹±æå¯¿éƒ Â· 12æœˆ12æ—¥</div>
                </div>
              </div>
              <div class="favorites-item">
                <div class="favorites-item-avatar" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                  <i class="fa-solid fa-cat"></i>
                </div>
                <div class="favorites-item-content">
                  <div class="favorites-item-title">å°é›ªçš„æ’’å¨‡</div>
                  <div class="favorites-item-preview">ã€Œå–µï½ä¸»äººä¸è¦ç¦»å¼€å°é›ªå˜›...ã€</div>
                  <div class="favorites-item-meta">çŒ«å¨˜å°é›ª Â· 12æœˆ10æ—¥</div>
                </div>
              </div>
              <div class="favorites-item invalid">
                <div class="favorites-item-avatar" style="background: #ccc;"><i class="fa-solid fa-question"></i></div>
                <div class="favorites-item-content">
                  <div class="favorites-item-title">æµ‹è¯•å¯¹è¯</div>
                  <div class="favorites-item-preview">åŸæ¶ˆæ¯å·²è¢«åˆ é™¤</div>
                  <div class="favorites-item-meta">æœªçŸ¥è§’è‰² Â· 12æœˆ5æ—¥</div>
                </div>
              </div>
            </div>
          </div>
          <div class="favorites-group collapsed">
            <div class="favorites-group-header">
              <i class="fa-solid fa-caret-down favorites-group-arrow"></i>
              <div class="favorites-group-title">ç²¾å½©ç‰‡æ®µ</div>
              <div class="favorites-group-count">2</div>
            </div>
            <div class="favorites-group-items"></div>
          </div>
        </div>
        <div class="favorites-manage-btn"><i class="fa-solid fa-folder-plus"></i><span>ç®¡ç†åˆ†ç»„</span></div>
      </div>

      <!-- ========== ç¬”è®°é¡µé¢ ========== -->
      <div class="archive-page" id="page-notes">
        <!-- åˆ†ç±»ç­›é€‰ -->
        <div class="notes-filter">
          <div class="notes-filter-tag active">å…¨éƒ¨</div>
          <div class="notes-filter-tag">ç»å…¸å°è¯</div>
          <div class="notes-filter-tag">ä¸–ç•Œè§‚</div>
          <div class="notes-filter-tag">æ„ŸåŠ¨ç‰‡æ®µ</div>
          <div class="notes-filter-tag">å¾…æ•´ç†</div>
          <div class="notes-filter-tag add-tag"><i class="fa-solid fa-plus"></i> æ–°åˆ†ç±»</div>
        </div>
        <!-- ç¬”è®°åˆ—è¡¨ -->
        <div class="notes-list">
          <div class="note-item">
            <div class="note-item-header">
              <div class="note-item-avatar"><i class="fa-solid fa-fire"></i></div>
              <div class="note-item-source">
                <div class="note-item-char">ç‚¼ç‹±æå¯¿éƒ</div>
                <div class="note-item-chat">2025-12-12 @20h 53m</div>
              </div>
              <div class="note-item-tags">
                <span class="note-item-tag">ç»å…¸å°è¯</span>
              </div>
            </div>
            <div class="note-item-content">ã€Œå¿ƒã‚’ç‡ƒã‚„ã›ï¼ã€â€”â€”ç‡ƒçƒ§ä½ çš„å¿ƒå§ï¼æ— è®ºé‡åˆ°ä»€ä¹ˆå›°éš¾ï¼Œéƒ½ä¸è¦æ”¾å¼ƒï¼</div>
            <div class="note-item-preview">è¿™æ˜¯æå¯¿éƒæœ€ç»å…¸çš„å°è¯ï¼Œæ¯æ¬¡çœ‹åˆ°éƒ½å¾ˆæ„ŸåŠ¨ã€‚å¯ä»¥ç”¨åœ¨éœ€è¦é¼“åŠ±è‡ªå·±çš„æ—¶å€™ã€‚</div>
          </div>
          <div class="note-item">
            <div class="note-item-header">
              <div class="note-item-avatar" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <i class="fa-solid fa-book"></i>
              </div>
              <div class="note-item-source">
                <div class="note-item-char">è®¾å®šé›†</div>
                <div class="note-item-chat">2025-12-01 @14h 22m</div>
              </div>
              <div class="note-item-tags">
                <span class="note-item-tag">ä¸–ç•Œè§‚</span>
              </div>
            </div>
            <div class="note-item-content">è¿™ä¸ªä¸–ç•Œç”±ä¸ƒå¤§å…ƒç´ æ„æˆï¼šç«ã€æ°´ã€é£ã€åœŸã€å…‰ã€æš—ã€è™šç©º...</div>
            <div class="note-item-preview">é‡è¦çš„ä¸–ç•Œè§‚è®¾å®šï¼Œåç»­å‰§æƒ…å¯èƒ½ä¼šç”¨åˆ°ã€‚è®°å¾—å’Œè§’è‰²å¡çš„è®¾å®šä¿æŒä¸€è‡´ã€‚</div>
          </div>
          <div class="note-item">
            <div class="note-item-header">
              <div class="note-item-avatar" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                <i class="fa-solid fa-heart"></i>
              </div>
              <div class="note-item-source">
                <div class="note-item-char">æ‹çˆ±è§’è‰²</div>
                <div class="note-item-chat">2025-12-08 @09h 15m</div>
              </div>
              <div class="note-item-tags">
                <span class="note-item-tag">æ„ŸåŠ¨ç‰‡æ®µ</span>
              </div>
            </div>
            <div class="note-item-content">ã€Œæˆ‘ä¸€ç›´éƒ½å¾ˆå–œæ¬¢ä½ ...ä»ç¬¬ä¸€æ¬¡è§é¢å¼€å§‹ï¼Œå°±æ— æ³•ç§»å¼€è§†çº¿ã€</div>
            <div class="note-item-preview">è¶…çº§æ„ŸåŠ¨çš„å‘Šç™½åœºæ™¯ï¼è¿™æ®µå¯¹è¯å†™å¾—å¤ªå¥½äº†ï¼Œè¦ä¿å­˜ä¸‹æ¥ã€‚</div>
          </div>
        </div>
      </div>

      <!-- ========== é˜…è¯»æ¨¡å¼ - è§’è‰²åˆ—è¡¨é¡µ ========== -->
      <div class="archive-page" id="page-reader">
        <div class="reader-char-list">
          <div class="reader-char-search"><input type="text" placeholder="æœç´¢è§’è‰²..."></div>
          <div class="reader-char-item" data-char="rengoku">
            <div class="reader-char-avatar"><i class="fa-solid fa-fire" style="font-size: 1.5em; color: white;"></i></div>
            <div class="reader-char-info">
              <div class="reader-char-name">ç‚¼ç‹±æå¯¿éƒ</div>
              <div class="reader-char-stats">3 ä¸ªèŠå¤©è®°å½• Â· å…± 156 æ¡æ¶ˆæ¯</div>
            </div>
            <div class="reader-char-arrow"><i class="fa-solid fa-chevron-right"></i></div>
          </div>
          <div class="reader-char-item" data-char="cat">
            <div class="reader-char-avatar" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
              <i class="fa-solid fa-cat" style="font-size: 1.5em; color: white;"></i>
            </div>
            <div class="reader-char-info">
              <div class="reader-char-name">çŒ«å¨˜å°é›ª</div>
              <div class="reader-char-stats">5 ä¸ªèŠå¤©è®°å½• Â· å…± 423 æ¡æ¶ˆæ¯</div>
            </div>
            <div class="reader-char-arrow"><i class="fa-solid fa-chevron-right"></i></div>
          </div>
          <div class="reader-char-item" data-char="ai">
            <div class="reader-char-avatar" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
              <i class="fa-solid fa-robot" style="font-size: 1.5em; color: white;"></i>
            </div>
            <div class="reader-char-info">
              <div class="reader-char-name">AIåŠ©æ‰‹</div>
              <div class="reader-char-stats">2 ä¸ªèŠå¤©è®°å½• Â· å…± 89 æ¡æ¶ˆæ¯</div>
            </div>
            <div class="reader-char-arrow"><i class="fa-solid fa-chevron-right"></i></div>
          </div>
        </div>
      </div>

      <!-- ========== é˜…è¯»æ¨¡å¼ - èŠå¤©è®°å½•åˆ—è¡¨é¡µ ========== -->
      <div class="archive-page" id="page-reader-chats">
        <div class="reader-chat-list">
          <div class="reader-chat-item" data-chat="1">
            <div class="reader-chat-icon"><i class="fa-solid fa-comments"></i></div>
            <div class="reader-chat-info">
              <div class="reader-chat-name">2025-12-12 @20h 53m 33s</div>
              <div class="reader-chat-meta">15 æ¡æ¶ˆæ¯ Â· 5.42 KB</div>
            </div>
          </div>
          <div class="reader-chat-item" data-chat="2">
            <div class="reader-chat-icon"><i class="fa-solid fa-comments"></i></div>
            <div class="reader-chat-info">
              <div class="reader-chat-name">2025-12-10 @14h 22m 15s</div>
              <div class="reader-chat-meta">42 æ¡æ¶ˆæ¯ Â· 18.7 KB</div>
            </div>
          </div>
        </div>
      </div>

      <!-- ========== é˜…è¯»æ¨¡å¼ - é˜…è¯»è§†å›¾ ========== -->
      <div class="archive-page" id="page-reader-view">
        <div class="reader-view">
          <div class="reader-content">
            <div class="reader-message">
              <div class="reader-message-sender user">ã€ä½ ã€‘</div>
              <div class="reader-message-text">ä½ å¥½å•Šï¼Œæå¯¿éƒï¼ä»Šå¤©çš„å¤©æ°”çœŸä¸é”™ã€‚</div>
              <div class="reader-message-divider"></div>
            </div>
            <div class="reader-message">
              <div class="reader-message-sender">ã€ç‚¼ç‹±æå¯¿éƒã€‘</div>
              <div class="reader-message-text">å“ˆå“ˆå“ˆï¼ä½ å¥½å•Šï¼ç¡®å®æ˜¯ä¸ªé€‚åˆä¿®ç‚¼çš„å¥½å¤©æ°”ï¼å¿ƒã‚’ç‡ƒã‚„ã›ï¼è®©æˆ‘ä»¬ä¸€èµ·ç‡ƒçƒ§èµ·æ¥å§ï¼</div>
              <div class="reader-message-divider"></div>
            </div>
            <div class="reader-message">
              <div class="reader-message-sender user">ã€ä½ ã€‘</div>
              <div class="reader-message-text">ä½ æ€»æ˜¯è¿™ä¹ˆæœ‰æ´»åŠ›å‘¢...</div>
              <div class="reader-message-divider"></div>
            </div>
            <div class="reader-message">
              <div class="reader-message-sender">ã€ç‚¼ç‹±æå¯¿éƒã€‘</div>
              <div class="reader-message-text">å½“ç„¶ï¼ä½œä¸ºç‚æŸ±ï¼Œæˆ‘å¿…é¡»æ—¶åˆ»ä¿æŒæœ€ä½³çŠ¶æ€ï¼æ— è®ºé‡åˆ°ä»€ä¹ˆå›°éš¾ï¼Œéƒ½è¦å‹‡å¾€ç›´å‰ï¼</div>
              <div class="reader-message-divider"></div>
            </div>
          </div>
          <div class="reader-bottom-bar">
            <div class="reader-progress">
              <div class="reader-progress-bar"><div class="reader-progress-fill"></div></div>
              <div class="reader-progress-text">4 / 15</div>
            </div>
            <div class="reader-controls">
              <div class="reader-control-group">
                <span class="reader-control-label">è·³è½¬åˆ°ç¬¬</span>
                <input type="number" class="reader-control-input" value="1" min="1">
                <span class="reader-control-label">æ¡</span>
                <button class="reader-control-btn">è·³è½¬</button>
              </div>
              <button class="reader-control-btn secondary"><i class="fa-solid fa-arrow-up-right-from-square"></i></button>
            </div>
          </div>
        </div>
      </div>

      <!-- ========== æ”¶è—è¯¦æƒ…é¡µï¼ˆæ–°è®¾è®¡ï¼šä¸Šä¸‹åŠ è½½æŒ‰é’®ï¼‰ ========== -->
      <div class="favorite-detail" id="favorite-detail">
        <div class="favorite-detail-header">
          <div class="favorite-detail-back"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="favorite-detail-title">æå¯¿éƒçš„ç»å…¸å°è¯</div>
          <div class="favorite-detail-actions">
            <div class="favorite-detail-action" title="è·³è½¬åŸä½ç½®"><i class="fa-solid fa-arrow-up-right-from-square"></i></div>
            <div class="favorite-detail-action" title="ç¼–è¾‘"><i class="fa-solid fa-pen"></i></div>
          </div>
        </div>

        <!-- å‘ä¸ŠåŠ è½½æ›´å¤š -->
        <div class="context-load-more" id="load-more-up">
          <i class="fa-solid fa-chevron-up"></i>
          <span>å‘ä¸Šçœ‹</span>
          <input type="number" value="3" min="1" max="50">
          <span>æ¡</span>
        </div>

        <!-- æ¶ˆæ¯åŒºåŸŸ -->
        <div class="favorite-messages">
          <div class="favorite-message">
            <div class="favorite-message-avatar"></div>
            <div class="favorite-message-bubble">ä½ è§‰å¾—ä»€ä¹ˆæ˜¯æœ€é‡è¦çš„ï¼Ÿ</div>
          </div>
          <div class="favorite-message">
            <div class="favorite-message-avatar"></div>
            <div class="favorite-message-bubble">ä½œä¸ºä¸€ä¸ªå‰‘å£«ï¼Œæˆ‘è®¤ä¸º...</div>
          </div>
          <div class="favorite-message highlighted">
            <div class="favorite-message-avatar"></div>
            <div class="favorite-message-bubble">ã€Œå¿ƒã‚’ç‡ƒã‚„ã›ï¼ã€â€”â€”ç‡ƒçƒ§ä½ çš„å¿ƒå§ï¼æ— è®ºé‡åˆ°ä»€ä¹ˆå›°éš¾ï¼Œéƒ½ä¸è¦æ”¾å¼ƒï¼è¿™å°±æ˜¯æˆ‘ç‚¼ç‹±æå¯¿éƒçš„ä¿¡å¿µï¼</div>
          </div>
          <div class="favorite-message sent">
            <div class="favorite-message-avatar"></div>
            <div class="favorite-message-bubble">å¤ªæ„ŸåŠ¨äº†...</div>
          </div>
        </div>

        <!-- å‘ä¸‹åŠ è½½æ›´å¤š -->
        <div class="context-load-more" id="load-more-down">
          <i class="fa-solid fa-chevron-down"></i>
          <span>å‘ä¸‹çœ‹</span>
          <input type="number" value="3" min="1" max="50">
          <span>æ¡</span>
        </div>

        <!-- ç¬”è®°åŒºåŸŸï¼ˆå¸¦åˆ†ç±»ï¼‰ -->
        <div class="favorite-notes">
          <div class="favorite-notes-header">
            <i class="fa-solid fa-note-sticky"></i>
            <span>æˆ‘çš„ç¬”è®°</span>
            <i class="fa-solid fa-chevron-down"></i>
          </div>
          <div class="favorite-notes-content">
            <div class="favorite-notes-tags">
              <div class="favorite-notes-tag active">ç»å…¸å°è¯</div>
              <div class="favorite-notes-tag">ä¸–ç•Œè§‚</div>
              <div class="favorite-notes-tag">æ„ŸåŠ¨ç‰‡æ®µ</div>
              <div class="favorite-notes-tag add-tag"><i class="fa-solid fa-plus"></i></div>
            </div>
            <textarea class="favorite-notes-textarea" placeholder="åœ¨è¿™é‡Œå†™ä¸‹ä½ çš„æƒ³æ³•...">è¿™æ˜¯æå¯¿éƒæœ€ç»å…¸çš„å°è¯ï¼Œæ¯æ¬¡çœ‹åˆ°éƒ½å¾ˆæ„ŸåŠ¨ã€‚å¯ä»¥ç”¨åœ¨éœ€è¦é¼“åŠ±è‡ªå·±çš„æ—¶å€™ã€‚</textarea>
          </div>
        </div>
      </div>
    </div>

    <!-- åº•éƒ¨å¯¼èˆªæ ï¼ˆ4ä¸ªæ ‡ç­¾ï¼‰ -->
    <div class="archive-nav">
      <div class="archive-nav-item active" data-page="search">
        <i class="fa-solid fa-magnifying-glass"></i>
        <span>æœç´¢</span>
      </div>
      <div class="archive-nav-item" data-page="favorites">
        <i class="fa-solid fa-star"></i>
        <span>æ”¶è—å¤¹</span>
      </div>
      <div class="archive-nav-item" data-page="notes">
        <i class="fa-solid fa-note-sticky"></i>
        <span>ç¬”è®°</span>
      </div>
      <div class="archive-nav-item" data-page="reader">
        <i class="fa-solid fa-book-open"></i>
        <span>é˜…è¯»</span>
      </div>
    </div>
  </div>

  <script>
    let pageStack = ['page-search'];

    function showPage(pageId, addToStack = true) {
      document.querySelectorAll('.archive-page').forEach(p => p.classList.remove('active'));
      document.getElementById(pageId).classList.add('active');
      document.getElementById('favorite-detail').classList.remove('active');

      if (addToStack && pageStack[pageStack.length - 1] !== pageId) {
        pageStack.push(pageId);
      }

      const titles = {
        'page-search': 'èŠå¤©è®°å½•ç®¡ç†',
        'page-favorites': 'æ”¶è—å¤¹',
        'page-notes': 'æˆ‘çš„ç¬”è®°',
        'page-reader': 'é€‰æ‹©è§’è‰²',
        'page-reader-chats': 'é€‰æ‹©èŠå¤©è®°å½•',
        'page-reader-view': 'é˜…è¯»æ¨¡å¼'
      };
      document.querySelector('.archive-header-title').textContent = titles[pageId] || 'èŠå¤©è®°å½•ç®¡ç†';
    }

    // å¯¼èˆªåˆ‡æ¢
    document.querySelectorAll('.archive-nav-item').forEach(item => {
      item.addEventListener('click', () => {
        document.querySelectorAll('.archive-nav-item').forEach(i => i.classList.remove('active'));
        item.classList.add('active');
        const pageId = 'page-' + item.dataset.page;
        pageStack = [pageId];
        showPage(pageId, false);
      });
    });

    // è¿”å›æŒ‰é’®
    document.querySelector('.archive-header-back').addEventListener('click', () => {
      if (pageStack.length > 1) {
        pageStack.pop();
        showPage(pageStack[pageStack.length - 1], false);
      }
    });

    // åˆ†ç»„æŠ˜å 
    document.querySelectorAll('.favorites-group-header').forEach(header => {
      header.addEventListener('click', () => header.parentElement.classList.toggle('collapsed'));
    });

    // ç‚¹å‡»æ”¶è—é¡¹æ˜¾ç¤ºè¯¦æƒ…
    document.querySelectorAll('.favorites-item:not(.invalid)').forEach(item => {
      item.addEventListener('click', () => document.getElementById('favorite-detail').classList.add('active'));
    });

    // è¯¦æƒ…é¡µè¿”å›
    document.querySelector('.favorite-detail-back').addEventListener('click', () => {
      document.getElementById('favorite-detail').classList.remove('active');
    });

    // ç¬”è®°åˆ†ç±»ç­›é€‰
    document.querySelectorAll('.notes-filter-tag:not(.add-tag)').forEach(tag => {
      tag.addEventListener('click', () => {
        document.querySelectorAll('.notes-filter-tag').forEach(t => t.classList.remove('active'));
        tag.classList.add('active');
      });
    });

    // ç¬”è®°åˆ†ç±»é€‰æ‹©ï¼ˆè¯¦æƒ…é¡µï¼‰
    document.querySelectorAll('.favorite-notes-tag:not(.add-tag)').forEach(tag => {
      tag.addEventListener('click', () => tag.classList.toggle('active'));
    });

    // é˜…è¯»æ¨¡å¼å¯¼èˆª
    document.querySelectorAll('.reader-char-item').forEach(item => {
      item.addEventListener('click', () => showPage('page-reader-chats'));
    });
    document.querySelectorAll('.reader-chat-item').forEach(item => {
      item.addEventListener('click', () => showPage('page-reader-view'));
    });

    // ç‚¹å‡»ç¬”è®°é¡¹è·³è½¬åˆ°æ”¶è—è¯¦æƒ…
    document.querySelectorAll('.note-item').forEach(item => {
      item.addEventListener('click', () => document.getElementById('favorite-detail').classList.add('active'));
    });
  </script>
</body>
</html>

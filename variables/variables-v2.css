/**
 * 动态变量系统 V2 - 样式文件
 * 版本：2.0 - 手机风格重构
 *
 * 设计风格：和点心铺手机一致
 * - 小屏幕：全屏显示
 * - 大屏幕：手机大小窗口 + 可拖动
 */

/* ============================================
   CSS 变量（继承手机风格）
   ============================================ */

:root {
  /* ========================================
       窗口尺寸（保持不变）
       ======================================== */
  --var-v2-window-width: 375px;
  --var-v2-window-height: 600px;
  --var-v2-header-height: 2.8em;

  /* ========================================
       颜色变量 - 继承SillyTavern官方主题
       ======================================== */

  /* 主色调 - 使用官方 QuoteColor（橙色），这是SillyTavern的强调色 */
  --var-v2-primary: var(--SmartThemeQuoteColor);
  --var-v2-primary-dark: var(--SmartThemeQuoteColor);
  --var-v2-primary-light: color-mix(in srgb, var(--SmartThemeQuoteColor) 20%, transparent);

  /* 背景色 - 使用官方背景变量 */
  /* 注意：ChatTintColor 可能是透明的，改用 BlurTintColor */
  --var-v2-bg-main: var(--SmartThemeBlurTintColor);
  --var-v2-bg-white: var(--SmartThemeBlurTintColor);
  --var-v2-bg-card: var(--SmartThemeBlurTintColor);

  /* 文字色 - 使用官方文字颜色 */
  --var-v2-text-primary: var(--SmartThemeBodyColor);
  --var-v2-text-secondary: var(--SmartThemeEmColor);
  --var-v2-text-white: var(--SmartThemeBodyColor);

  /* 边框色 - 使用官方边框变量 */
  --var-v2-border: var(--SmartThemeBorderColor);

  /* 状态色 - 使用官方状态变量 */
  --var-v2-danger: var(--preferred);
  --var-v2-warning: var(--warning);
  --var-v2-success: var(--active);
}

/* ============================================
   1. 主窗口容器
   ============================================ */

.var-v2-window {
  position: fixed;
  z-index: 9998;
  background: var(--var-v2-bg-main);
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);
  overflow: hidden;
  display: flex;
  flex-direction: column;

  /* 大屏幕默认尺寸和位置 */
  width: var(--var-v2-window-width);
  height: var(--var-v2-window-height);
  max-height: 80vh;

  /* 字体基准 */
  font-size: 16px;
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  color: var(--var-v2-text-primary);
  line-height: 1.5;
}

/* 小屏幕全屏 */
@media (max-width: 768px) {
  .var-v2-window {
    position: fixed;
    top: 0 !important;
    left: 0 !important;
    right: 0;
    bottom: 0;
    width: 100vw !important;
    height: 100vh !important;
    height: 100dvh !important;
    max-height: none;
    border-radius: 0;
    box-shadow: none;
  }
}

/* ============================================
   2. 顶部栏（可拖动）
   ============================================ */

.var-v2-header {
  height: var(--var-v2-header-height);
  background: var(--var-v2-bg-white);
  display: flex;
  align-items: center;
  padding: 0 12px;
  flex-shrink: 0;
  cursor: move;
  user-select: none;
}

.var-v2-header-title {
  flex: 1;
  font-size: 0.9375em;
  font-weight: 500;
  color: var(--var-v2-text-primary);
}

.var-v2-header-actions {
  display: flex;
  gap: 4px;
}

.var-v2-header-btn {
  width: 26px;
  height: 26px;
  background: none;
  border: none;
  font-size: 0.875em;
  color: var(--var-v2-text-secondary);
  cursor: pointer;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.15s;
}

.var-v2-header-btn:hover {
  background: var(--var-v2-bg-main);
  color: var(--var-v2-text-primary);
}

.var-v2-close-btn:hover {
  background: var(--var-v2-danger);
  color: var(--var-v2-text-white);
}

/* ============================================
   2.5 套装选择器行（标题栏下方）
   ============================================ */

.var-v2-suite-row {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 4px 12px 8px;
  background: var(--var-v2-bg-white);
  flex-shrink: 0;
}

.var-v2-select-compact {
  padding: 4px 8px;
  border-radius: 4px;
  border: 1px solid var(--var-v2-border);
  background: var(--var-v2-bg-main);
  color: var(--var-v2-text-primary);
  font-size: 0.8125em;
  cursor: pointer;
  min-width: 80px;
  max-width: 140px;
}

.var-v2-select-compact:focus {
  outline: none;
  border-color: var(--var-v2-primary);
}

.var-v2-trigger-badge {
  display: flex;
  align-items: center;
  gap: 3px;
  font-size: 0.6875em;
  color: var(--var-v2-text-secondary);
  white-space: nowrap;
  margin-left: auto;
}

.var-v2-trigger-badge i {
  font-size: 0.875em;
}

.var-v2-status-dot {
  width: 5px;
  height: 5px;
  border-radius: 50%;
  margin-left: 2px;
}

.var-v2-status-dot.enabled {
  background: var(--var-v2-success);
}

.var-v2-status-dot.disabled {
  background: var(--var-v2-text-secondary);
}

.var-v2-suite-icon {
  cursor: pointer;
  padding: 4px;
  color: var(--var-v2-text-secondary);
  font-size: 0.75em;
  transition: color 0.15s;
}

.var-v2-suite-icon:hover {
  color: var(--var-v2-primary);
}

.var-v2-delete-suite-icon:hover {
  color: var(--var-v2-danger);
}

/* ============================================
   3. 内容区域
   ============================================ */

.var-v2-body {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 12px;
  background: var(--var-v2-bg-main);
}

/* 滚动条样式 */
.var-v2-body::-webkit-scrollbar {
  width: 4px;
}

.var-v2-body::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.1);
  border-radius: 2px;
}

.var-v2-body::-webkit-scrollbar-thumb:hover {
  background: rgba(0, 0, 0, 0.2);
}

/* ============================================
   4. 页面切换
   ============================================ */

.var-v2-page {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
}

.var-v2-page.hidden {
  display: none;
}

/* ============================================
   4.5 标签页
   ============================================ */

.var-v2-tabs {
  display: flex;
  background: var(--var-v2-bg-white);
  border-radius: 8px;
  margin-bottom: 8px;
  overflow: hidden;
}

.var-v2-tab {
  flex: 1;
  padding: 8px 12px;
  text-align: center;
  font-size: 0.8125em;
  color: var(--var-v2-text-secondary);
  cursor: pointer;
  transition: all 0.15s;
  border-bottom: 2px solid transparent;
}

.var-v2-tab:hover {
  color: var(--var-v2-text-primary);
  background: var(--var-v2-bg-main);
}

.var-v2-tab.active {
  color: var(--var-v2-primary);
  border-bottom-color: var(--var-v2-primary);
  font-weight: 500;
}

.var-v2-tab-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-height: 0;
  overflow-y: auto;
}

.var-v2-tab-content.hidden {
  display: none;
}

/* ============================================
   5. 按钮样式
   ============================================ */

.var-v2-btn {
  padding: 8px 12px;
  border-radius: 6px;
  border: none;
  background: var(--var-v2-bg-main);
  color: var(--var-v2-text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  font-size: 0.875em;
  transition: all 0.15s;
  white-space: nowrap;
}

.var-v2-btn:hover {
  background: var(--var-v2-border);
}

.var-v2-btn:active {
  transform: scale(0.98);
}

.var-v2-btn.primary {
  background: var(--var-v2-primary);
  color: var(--var-v2-text-white);
}

.var-v2-btn.primary:hover {
  background: var(--var-v2-primary-dark);
}

.var-v2-btn.warning {
  background: var(--var-v2-warning);
  color: var(--var-v2-text-white);
}

.var-v2-btn.warning:hover {
  background: var(--SmartThemeQuoteColor);
}

.var-v2-btn.danger {
  background: var(--var-v2-danger);
  color: var(--var-v2-text-white);
}

.var-v2-btn.danger:hover {
  background: var(--preferred);
}

.var-v2-btn.small {
  padding: 6px 10px;
  font-size: 0.8125em;
}

.var-v2-btn.icon-only {
  padding: 8px;
  width: 32px;
  height: 32px;
}

.var-v2-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

/* 确保按钮内图标不阻挡点击 */
.var-v2-btn i {
  pointer-events: none;
}

/* ============================================
   6. 条目列表
   ============================================ */

.var-v2-items-section {
  background: var(--var-v2-bg-white);
  border-radius: 8px;
  overflow: hidden;
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
}

.var-v2-items-header {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  padding: 8px 12px;
  background: var(--var-v2-bg-white);
  flex-shrink: 0;
}

.var-v2-actions {
  display: flex;
  gap: 6px;
}

.var-v2-items-list {
  flex: 1;
  overflow-y: auto;
  min-height: 100px;
}

.var-v2-empty {
  text-align: center;
  padding: 16px;
  color: var(--var-v2-text-secondary);
  font-size: 0.8125em;
}

/* 条目项（紧凑版） */
.var-v2-item {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 6px 8px;
  background: var(--var-v2-bg-white);
  cursor: pointer;
  transition: background 0.1s;
  border-top: 1px solid var(--var-v2-bg-main);
}

.var-v2-item:first-child {
  border-top: none;
}

.var-v2-item:active {
  background: var(--var-v2-bg-main);
}

.var-v2-item.prompt {
  border-left: 2px solid var(--var-v2-primary);
}

.var-v2-item.variable {
  border-left: 2px solid var(--var-v2-success);
}

.var-v2-drag-handle {
  color: var(--var-v2-text-secondary);
  opacity: 0.3;
  cursor: grab;
  padding: 0 2px;
  font-size: 0.75em;
}

.var-v2-drag-handle:hover {
  opacity: 0.7;
}

.var-v2-item-icon {
  color: var(--var-v2-primary);
  width: 16px;
  text-align: center;
  font-size: 0.75em;
}

.var-v2-item-toggle {
  width: 20px;
  text-align: center;
}

.var-v2-item-toggle .fa-toggle-on {
  color: var(--var-v2-success);
  font-size: 1em;
}

.var-v2-item-toggle .fa-toggle-off {
  color: var(--var-v2-text-secondary);
  font-size: 1em;
}

.var-v2-item-content {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-size: 0.75em;
  color: var(--var-v2-text-primary);
}

.var-v2-item-name {
  flex: 1;
  font-family: monospace;
  font-size: 0.75em;
  color: var(--var-v2-primary);
}

.var-v2-item-mode {
  font-size: 0.625em;
  padding: 1px 4px;
  border-radius: 2px;
  background: var(--var-v2-bg-main);
  color: var(--var-v2-text-secondary);
}

.var-v2-item-actions {
  display: flex;
  gap: 4px;
  opacity: 0.4;
}

.var-v2-item-actions i {
  cursor: pointer;
  padding: 2px;
  font-size: 0.75em;
}

.var-v2-item-actions i:hover {
  opacity: 1;
  color: var(--var-v2-primary);
}

.var-v2-item-actions .fa-trash:hover {
  color: var(--var-v2-danger);
}

/* ============================================
   7. 预览区（卡片式）
   ============================================ */

.var-v2-preview-card {
  background: var(--var-v2-bg-white);
  border-radius: 8px;
  overflow: hidden;
}

.var-v2-preview-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  font-size: 0.8125em;
  font-weight: 500;
  color: var(--var-v2-text-secondary);
}

.var-v2-preview-card-content {
  padding: 12px;
  font-size: 0.8125em;
  max-height: 200px;
  overflow-y: auto;
  white-space: pre-wrap;
  word-break: break-word;
  color: var(--var-v2-text-primary);
  background: var(--var-v2-bg-main);
  margin: 0 8px 8px;
  border-radius: 6px;
  line-height: 1.6;
}

.var-v2-preview-card-textarea {
  width: calc(100% - 16px);
  min-height: 120px;
  max-height: 200px;
  padding: 12px;
  font-size: 0.8125em;
  white-space: pre-wrap;
  word-break: break-word;
  color: var(--var-v2-text-primary);
  background: var(--var-v2-bg-main);
  margin: 0 8px 8px;
  border-radius: 6px;
  border: 1px solid var(--var-v2-border);
  resize: vertical;
  font-family: inherit;
  line-height: 1.6;
}

.var-v2-preview-card-textarea:focus {
  outline: none;
  border-color: var(--var-v2-primary);
}

/* ============================================
   8. 悬浮发送按钮 (FAB)
   ============================================ */

.var-v2-fab {
  position: absolute;
  bottom: 16px;
  right: 16px;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: var(--var-v2-primary);
  color: var(--var-v2-text-white);
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.9375em;
  box-shadow: 0 4px 12px color-mix(in srgb, var(--SmartThemeQuoteColor) 30%, transparent);
  transition: all 0.2s;
  z-index: 10;
}

.var-v2-fab:hover {
  background: var(--var-v2-primary-dark);
  transform: scale(1.05);
  box-shadow: 0 6px 16px color-mix(in srgb, var(--SmartThemeQuoteColor) 40%, transparent);
}

.var-v2-fab:active {
  transform: scale(0.95);
}

.var-v2-fab:disabled {
  background: var(--var-v2-text-secondary);
  cursor: not-allowed;
  box-shadow: none;
}

.var-v2-fab.analyzing {
  background: var(--var-v2-danger);
}

.var-v2-fab i {
  pointer-events: none;
}

/* 小屏幕 FAB 位置调整 */
@media (max-width: 768px) {
  .var-v2-fab {
    bottom: 20px;
    right: 20px;
    width: 44px;
    height: 44px;
    font-size: 1em;
  }
}

/* ============================================
   9. 拖拽排序
   ============================================ */

.var-v2-item.dragging {
  opacity: 0.5;
  background: var(--var-v2-primary-light);
}

.var-v2-item.drag-over-top {
  box-shadow: inset 0 3px 0 var(--var-v2-primary);
}

.var-v2-item.drag-over-bottom {
  box-shadow: inset 0 -3px 0 var(--var-v2-primary);
}

/* ============================================
   10. 子弹窗（内部弹窗）
   ============================================ */

.var-v2-popup-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  height: 100dvh;
  background: rgba(0, 0, 0, 0.4);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10000;
  opacity: 0;
  transition: opacity 0.2s;
}

.var-v2-popup-overlay.show {
  opacity: 1;
}

.var-v2-popup {
  background: var(--var-v2-bg-white);
  border-radius: 12px;
  min-width: 300px;
  max-width: 90vw;
  max-height: 80vh;
  max-height: 80dvh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  transform: scale(0.95);
  transition: transform 0.2s;
}

/* 小屏幕弹窗适配 */
@media (max-width: 768px) {
  .var-v2-popup {
    min-width: unset;
    width: calc(100vw - 32px);
    max-width: calc(100vw - 32px);
    max-height: 70vh;
    max-height: 70dvh;
  }
}

.var-v2-popup-overlay.show .var-v2-popup {
  transform: scale(1);
}

.var-v2-popup-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  background: var(--var-v2-bg-white);
  border-bottom: 1px solid var(--var-v2-border);
}

.var-v2-popup-title {
  font-weight: 500;
  font-size: 1em;
  color: var(--var-v2-text-primary);
}

.var-v2-popup-close {
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  color: var(--var-v2-text-secondary);
}

.var-v2-popup-close:hover {
  background: var(--var-v2-bg-main);
  color: var(--var-v2-text-primary);
}

.var-v2-popup-body {
  padding: 16px;
  overflow-y: auto;
  flex: 1;
  background: var(--var-v2-bg-main);
}

.var-v2-popup-footer {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  padding: 12px 16px;
  background: var(--var-v2-bg-white);
}

/* ============================================
   11. 表单样式
   ============================================ */

.var-v2-form {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.var-v2-form-row {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.var-v2-form-row label {
  font-weight: 500;
  font-size: 0.875em;
  color: var(--var-v2-text-primary);
}

.var-v2-form-row input,
.var-v2-form-row select,
.var-v2-form-row textarea {
  padding: 10px 12px;
  border-radius: 6px;
  border: 1px solid var(--var-v2-border);
  background: var(--var-v2-bg-white);
  color: var(--var-v2-text-primary);
  font-size: 0.875em;
}

.var-v2-form-row input:focus,
.var-v2-form-row select:focus,
.var-v2-form-row textarea:focus {
  outline: none;
  border-color: var(--var-v2-primary);
}

.var-v2-form-row textarea {
  resize: vertical;
  min-height: 100px;
  font-family: monospace;
}

/* 添加变量弹窗中的已添加变量列表 */
.var-v2-added-vars-list {
  display: flex;
  flex-direction: column;
  gap: 6px;
  max-height: 200px;
  overflow-y: auto;
}

.var-v2-added-var-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: var(--var-v2-bg-light);
  border-radius: 6px;
  border: 1px solid var(--var-v2-border);
}

.var-v2-added-var-name {
  flex: 1;
  font-weight: 500;
  font-size: 0.875em;
  color: var(--var-v2-text-primary);
}

.var-v2-added-var-mode {
  font-size: 0.75em;
  color: var(--var-v2-text-secondary);
  background: var(--var-v2-bg-white);
  padding: 2px 6px;
  border-radius: 4px;
}

.var-v2-added-var-item .fa-trash {
  cursor: pointer;
  padding: 4px;
  font-size: 0.875em;
  color: var(--var-v2-text-secondary);
  opacity: 0.6;
  transition: all 0.2s;
}

.var-v2-added-var-item .fa-trash:hover {
  opacity: 1;
  color: var(--var-v2-danger);
}

.var-v2-hint {
  font-size: 0.75em;
  color: var(--var-v2-text-secondary);
}

/* ============================================
   12. 详情页样式（页面切换模式）
   ============================================ */

/* 详情页头部 */
.var-v2-detail-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: var(--var-v2-bg-white);
  border-radius: 8px;
  margin-bottom: 8px;
}

.var-v2-back-btn {
  width: 28px;
  height: 28px;
  border: none;
  background: var(--var-v2-bg-main);
  color: var(--var-v2-text-primary);
  border-radius: 6px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.875em;
  transition: all 0.15s;
}

.var-v2-back-btn:hover {
  background: var(--var-v2-primary);
  color: var(--var-v2-text-white);
}

.var-v2-detail-title {
  flex: 1;
  font-family: monospace;
  font-size: 0.875em;
  color: var(--var-v2-primary);
}

.var-v2-detail-mode {
  font-size: 0.6875em;
  padding: 2px 6px;
  border-radius: 3px;
  background: var(--var-v2-bg-main);
  color: var(--var-v2-text-secondary);
}

/* 详情页内容 */
.var-v2-detail-body {
  display: flex;
  flex-direction: column;
  gap: 8px;
  flex: 1;
  overflow-y: auto;
}

.var-v2-detail-info-compact {
  display: flex;
  gap: 12px;
  padding: 8px 12px;
  background: var(--var-v2-bg-white);
  border-radius: 8px;
  font-size: 0.75em;
  color: var(--var-v2-text-secondary);
}

/* 旧的详情页样式（保留兼容） */
.var-v2-detail-page {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.var-v2-detail-info {
  padding: 12px;
  background: var(--var-v2-bg-white);
  border-radius: 8px;
}

.var-v2-detail-row {
  padding: 6px 0;
  font-size: 0.875em;
}

.var-v2-detail-row strong {
  color: var(--var-v2-text-secondary);
  font-weight: normal;
  margin-right: 8px;
}

/* 条目列表（叠加模式） */
.var-v2-entries-section {
  background: var(--var-v2-bg-white);
  border-radius: 8px;
  overflow: hidden;
  flex: 1;
  display: flex;
  flex-direction: column;
}

.var-v2-entries-header {
  padding: 8px 12px;
  font-size: 0.8125em;
  font-weight: 500;
  flex-shrink: 0;
}

.var-v2-entries-list {
  flex: 1;
  overflow-y: auto;
}

.var-v2-entry {
  border-top: 1px solid var(--var-v2-bg-main);
}

.var-v2-entry:first-child {
  border-top: none;
}

.var-v2-entry.entry-hidden {
  opacity: 0.5;
}

.var-v2-entry-header {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 10px;
  cursor: pointer;
  transition: background 0.1s;
}

.var-v2-entry-header:active {
  background: var(--var-v2-bg-main);
}

.var-v2-entry-toggle {
  width: 14px;
  color: var(--var-v2-text-secondary);
  font-size: 0.6875em;
}

.var-v2-entry-title {
  font-weight: 500;
  font-size: 0.75em;
}

.var-v2-entry-time {
  font-size: 0.625em;
  color: var(--var-v2-text-secondary);
  margin-left: auto;
}

.var-v2-entry-actions {
  display: flex;
  gap: 6px;
}

.var-v2-entry-actions i {
  cursor: pointer;
  opacity: 0.5;
  padding: 2px;
  font-size: 0.75em;
}

.var-v2-entry-actions i:hover {
  opacity: 1;
  color: var(--var-v2-primary);
}

.var-v2-entry-actions .var-v2-entry-delete:hover {
  color: var(--var-v2-danger);
}

.var-v2-entry-content {
  padding: 6px 10px 10px 28px;
  font-size: 0.75em;
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.5;
  color: var(--var-v2-text-primary);
}

.var-v2-entry-content.collapsed {
  display: none;
}

/* 当前值（覆盖模式） */
.var-v2-current-section {
  background: var(--var-v2-bg-white);
  border-radius: 8px;
  overflow: hidden;
}

.var-v2-current-label {
  padding: 8px 12px;
  font-size: 0.75em;
  font-weight: 500;
  color: var(--var-v2-text-secondary);
}

.var-v2-current-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  font-size: 0.8125em;
  font-weight: 500;
}

.var-v2-floor-info {
  font-weight: normal;
  font-size: 0.6875em;
  color: var(--var-v2-text-secondary);
}

.var-v2-current-content {
  padding: 10px;
  font-size: 0.75em;
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.5;
  max-height: 180px;
  overflow-y: auto;
  background: var(--var-v2-bg-main);
  margin: 0 8px 8px;
  border-radius: 6px;
}

/* 历史导航 */
.var-v2-history-nav {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 12px;
  padding: 8px 12px;
  background: var(--var-v2-bg-white);
  border-radius: 8px;
}

.var-v2-history-nav #var-v2-pos {
  font-size: 0.75em;
  color: var(--var-v2-text-secondary);
  min-width: 50px;
  text-align: center;
}

.var-v2-history-actions {
  display: flex;
  justify-content: center;
  padding: 8px 12px;
  background: var(--var-v2-bg-white);
  border-radius: 8px;
}

/* 待处理内容区 */
.var-v2-pending-section {
  border: 2px dashed var(--var-v2-primary);
  border-radius: 8px;
  overflow: hidden;
  background: var(--var-v2-primary-light);
}

.var-v2-pending-header {
  padding: 8px 12px;
  font-weight: 500;
  font-size: 0.875em;
  color: var(--var-v2-primary);
}

.var-v2-pending-content {
  padding: 12px;
  font-size: 0.8125em;
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.6;
  max-height: 120px;
  overflow-y: auto;
}

.var-v2-pending-actions {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  padding: 8px 12px;
}

/* ============================================
   13. 复选框样式（覆盖酒馆默认）
   ============================================ */

.var-v2-window .checkbox_label {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  font-size: 0.875em;
}

.var-v2-window .checkbox_label input[type="checkbox"] {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

/* ============================================
   14. 单选按钮组样式
   ============================================ */

.var-v2-radio-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 8px 0;
}

.var-v2-radio-label {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  font-size: 0.875em;
  font-weight: normal;
  padding: 8px 12px;
  border-radius: 6px;
  background: var(--var-v2-bg-white);
  transition: background 0.15s;
}

.var-v2-radio-label:hover {
  background: var(--var-v2-bg-main);
}

.var-v2-radio-label input[type="radio"] {
  width: 16px;
  height: 16px;
  cursor: pointer;
  accent-color: var(--var-v2-primary);
}

.var-v2-radio-label input[type="radio"]:checked+span {
  color: var(--var-v2-primary);
  font-weight: 500;
}


/* ============================================
   15. API 设置弹窗样式（复制自手机模块）
   ============================================ */

/* API 设置弹窗容器 */
.var-v2-api-settings-popup {
  max-width: 500px;
  max-height: 70vh;
  overflow-y: auto;
}

/* 设置内容区 */
.api-settings-content {
  padding: 0.75em 1em;
  background: var(--var-v2-bg-main);
}

/* 设置分组 */
.api-settings-section {
  margin-bottom: 1em;
  background: var(--var-v2-bg-white);
  border-radius: 0.5em;
  padding: 0.625em 0.75em;
  overflow: hidden;
}

.api-settings-section-title {
  font-size: 0.875em;
  color: var(--var-v2-text-secondary);
  margin-bottom: 0.5em;
}

.api-settings-hint {
  font-size: 0.813em;
  color: var(--var-v2-text-secondary);
  margin-top: 0.5em;
  line-height: 1.4;
}

/* 下拉选择框 */
.api-settings-select {
  width: 100%;
  padding: 0.625em;
  background: var(--var-v2-bg-main);
  border: 1px solid var(--var-v2-border);
  border-radius: 0.25em;
  color: var(--var-v2-text-primary);
  font-size: 1em;
  cursor: pointer;
}

/* 复选框 */
.api-settings-checkbox {
  display: flex;
  align-items: center;
  gap: 0.5em;
  cursor: pointer;
  user-select: none;
}

.api-settings-checkbox input[type="checkbox"] {
  width: 1.25em;
  height: 1.25em;
  cursor: pointer;
}

.api-settings-checkbox span {
  font-size: 1em;
  color: var(--var-v2-text-primary);
}

/* 自定义API配置区（可折叠） */
.api-settings-custom {
  margin-top: 1em;
}

/* 横向按钮组 */
.api-settings-row {
  display: flex;
  gap: 0.5em;
  align-items: center;
}

.api-settings-row .api-settings-select {
  flex: 1;
}

/* 输入框 */
.api-settings-input {
  width: 100%;
  padding: 0.625em;
  background: var(--var-v2-bg-main);
  border: 1px solid var(--var-v2-border);
  border-radius: 0.25em;
  color: var(--var-v2-text-primary);
  font-size: 1em;
}

.api-settings-input::placeholder {
  color: var(--var-v2-text-secondary);
}

/* 密码输入框容器 */
.api-settings-password-wrapper {
  position: relative;
  width: 100%;
}

.api-settings-password-wrapper .api-settings-input {
  padding-right: 2.5em;
}

.api-settings-password-toggle {
  position: absolute;
  right: 0.5em;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: var(--var-v2-text-secondary);
  cursor: pointer;
  padding: 0.25em;
  transition: color 0.2s;
}

.api-settings-password-toggle:hover {
  color: var(--var-v2-text-primary);
}

/* 按钮 */
.api-settings-btn {
  padding: 0.625em 1em;
  background: var(--var-v2-bg-white);
  border: 1px solid var(--var-v2-border);
  border-radius: 0.25em;
  color: var(--var-v2-text-primary);
  font-size: 0.875em;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
}

.api-settings-btn:hover {
  background: var(--var-v2-bg-main);
}

.api-settings-btn:active {
  transform: scale(0.98);
}

/* 主要按钮（保存） */
.api-settings-btn-primary {
  background: var(--var-v2-primary);
  color: var(--SmartThemeBodyColor);
  border-color: var(--var-v2-primary);
}

.api-settings-btn-primary:hover {
  opacity: 0.9;
  background: var(--var-v2-primary);
}

/* 危险按钮（删除） */
.api-settings-btn-danger {
  background: var(--var-v2-danger);
  color: var(--SmartThemeBodyColor);
  border-color: var(--var-v2-danger);
  padding: 0.625em;
}

.api-settings-btn-danger:hover {
  opacity: 0.9;
  background: var(--var-v2-danger);
}

/* 测试连接按钮 */
.api-settings-btn-test {
  width: 100%;
  background: var(--var-v2-primary);
  color: var(--SmartThemeBodyColor);
  border-color: var(--var-v2-primary);
  padding: 0.75em;
  font-size: 1em;
}

.api-settings-btn-test:hover {
  opacity: 0.9;
  background: var(--var-v2-primary);
}

/* 高级参数滑块 */
.api-settings-range {
  width: 100%;
  cursor: pointer;
}

.api-settings-param {
  margin-bottom: 1em;
}


/* ============================================
   16. 正文条目样式
   ============================================ */

/* 正文条目在列表中的显示 */
.var-v2-item.chat-content {
  background: var(--var-v2-bg-white);
}

.var-v2-item.chat-content .var-v2-item-icon {
  color: var(--var-v2-primary);
}

/* 正文条目编辑弹窗 */
.var-v2-popup.chat-content-edit {
  width: 340px;
  max-width: 90vw;
}

.chat-content-field {
  margin-bottom: 12px;
}

.chat-content-field label {
  display: block;
  font-size: 0.8125em;
  color: var(--var-v2-text-secondary);
  margin-bottom: 4px;
}

.chat-content-hint {
  display: block;
  font-size: 0.75em;
  color: var(--var-v2-text-secondary);
  margin-top: 4px;
}

/* 参数输入区域 */
.chat-content-params {
  background: var(--var-v2-bg-main);
  border-radius: 6px;
  padding: 12px;
  margin-bottom: 12px;
}

.chat-content-param-row {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

.chat-content-param-row label {
  font-size: 0.875em;
  color: var(--var-v2-text-primary);
  margin-bottom: 0;
  white-space: nowrap;
}

.chat-content-param-row .var-v2-input.small {
  width: 60px;
  padding: 6px 8px;
  font-size: 0.875em;
}

.chat-content-param-row .var-v2-select.small {
  width: auto;
  padding: 6px 8px;
  font-size: 0.875em;
}

/* 预览区域 */
.chat-content-preview {
  background: var(--var-v2-primary-light);
  border-radius: 6px;
  padding: 10px 12px;
  margin-bottom: 12px;
}

.chat-content-preview .preview-label {
  font-size: 0.75em;
  color: var(--var-v2-text-secondary);
  margin-right: 4px;
}

#chat-content-preview-text {
  font-size: 0.875em;
  color: var(--var-v2-primary);
  font-weight: 500;
}

/* 聊天信息 */
.chat-content-info {
  text-align: right;
  margin-bottom: 8px;
}

.chat-content-info small {
  font-size: 0.75em;
  color: var(--var-v2-text-secondary);
}

/* 错误提示 */
.chat-content-error {
  background: color-mix(in srgb, var(--preferred) 10%, transparent);
  color: var(--var-v2-danger);
  padding: 8px 12px;
  border-radius: 6px;
  font-size: 0.8125em;
  margin-bottom: 12px;
}

.chat-content-error.hidden {
  display: none;
}

/* ============================================
   17. 正则设置弹窗样式
   ============================================ */

.var-v2-popup.regex-settings {
  width: 320px;
  max-width: 90vw;
}

.regex-hint {
  font-size: 0.75em;
  color: var(--var-v2-text-secondary);
  margin-bottom: 12px;
  line-height: 1.4;
}

.regex-group {
  margin-bottom: 12px;
}

.regex-group-header {
  font-size: 0.8125em;
  font-weight: 500;
  color: var(--var-v2-text-secondary);
  margin-bottom: 8px;
  padding-bottom: 4px;
  border-bottom: 1px solid var(--var-v2-border);
}

.regex-group-items {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.regex-script-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  background: var(--var-v2-bg-main);
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.15s;
}

.regex-script-item:hover {
  background: var(--var-v2-primary-light);
}

.regex-script-item input[type="checkbox"] {
  width: 16px;
  height: 16px;
  cursor: pointer;
  accent-color: var(--var-v2-primary);
}

.regex-script-item span {
  font-size: 0.875em;
  color: var(--var-v2-text-primary);
}

.regex-empty {
  font-size: 0.8125em;
  color: var(--var-v2-text-secondary);
  padding: 8px;
  text-align: center;
}

/* 弹窗遮罩层立即显示（不需要 .show 类） */
.var-v2-popup-overlay {
  opacity: 1;
}

.var-v2-popup-overlay .var-v2-popup {
  transform: scale(1);
}


/* ============================================
   18. 正则设置弹窗增强样式 (v2.1)
   ============================================ */

/* 正则按钮组 */
.regex-btn-group {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
  flex-wrap: wrap;
}

.regex-btn-group .var-v2-btn.small {
  flex: 1;
  min-width: 80px;
  font-size: 0.75em;
  padding: 6px 8px;
}

/* 正则分组标题增强 */
.regex-group-header {
  display: flex;
  align-items: center;
  gap: 6px;
}

.regex-group-header i {
  font-size: 0.875em;
  color: var(--var-v2-primary);
}

.regex-count {
  background: var(--var-v2-primary-light);
  color: var(--var-v2-primary);
  font-size: 0.75em;
  padding: 2px 6px;
  border-radius: 10px;
  margin-left: auto;
}

/* 正则脚本条目增强 */
.regex-script-item {
  position: relative;
  user-select: none;
}

.regex-drag-handle {
  color: var(--var-v2-text-secondary);
  cursor: grab;
  padding: 4px;
  opacity: 0.5;
  transition: opacity 0.15s;
}

.regex-script-item:hover .regex-drag-handle {
  opacity: 1;
}

.regex-script-label {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 1;
  cursor: pointer;
}

.regex-script-actions {
  display: flex;
  gap: 8px;
  opacity: 0;
  transition: opacity 0.15s;
}

.regex-script-item:hover .regex-script-actions {
  opacity: 1;
}

.regex-script-actions i {
  color: var(--var-v2-text-secondary);
  cursor: pointer;
  padding: 4px;
  font-size: 0.8125em;
  transition: color 0.15s;
}

.regex-script-actions i:hover {
  color: var(--var-v2-primary);
}

.regex-script-actions .regex-delete-custom:hover {
  color: var(--var-v2-danger);
}

/* 拖拽状态 */
.regex-script-item.dragging {
  opacity: 0.5;
  background: var(--var-v2-primary-light);
}

.regex-script-item.drag-over-top {
  border-top: 2px solid var(--var-v2-primary);
}

.regex-script-item.drag-over-bottom {
  border-bottom: 2px solid var(--var-v2-primary);
}

/* 正则编辑对话框 */
.var-v2-popup.regex-edit-dialog,
.var-v2-popup.regex-quick-gen-dialog,
.var-v2-popup.regex-help-dialog {
  width: 360px;
  max-width: 90vw;
}

.regex-edit-field {
  margin-bottom: 12px;
}

.regex-edit-field label {
  display: block;
  font-size: 0.8125em;
  color: var(--var-v2-text-secondary);
  margin-bottom: 4px;
}

.regex-edit-hint {
  font-size: 0.75em;
  color: var(--var-v2-text-secondary);
  margin-top: 4px;
}

.var-v2-textarea {
  width: 100%;
  padding: 8px 10px;
  border: 1px solid var(--var-v2-border);
  border-radius: 6px;
  font-size: 0.875em;
  font-family: monospace;
  resize: vertical;
  background: var(--var-v2-bg-white);
  color: var(--var-v2-text-primary);
}

.var-v2-textarea:focus {
  outline: none;
  border-color: var(--var-v2-primary);
}

/* 快速生成模式选择 */
.regex-gen-modes {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 12px;
}

.regex-gen-mode {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 10px 12px;
  background: var(--var-v2-bg-main);
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.15s;
}

.regex-gen-mode:hover {
  background: var(--var-v2-primary-light);
}

.regex-gen-mode input[type="radio"] {
  margin-top: 2px;
  accent-color: var(--var-v2-primary);
}

.regex-gen-mode .mode-content {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.regex-gen-mode .mode-title {
  font-size: 0.875em;
  font-weight: 500;
  color: var(--var-v2-text-primary);
}

.regex-gen-mode .mode-desc {
  font-size: 0.75em;
  color: var(--var-v2-text-secondary);
}

/* 正则预览 */
.regex-gen-preview {
  background: var(--var-v2-bg-main);
  border-radius: 6px;
  padding: 10px 12px;
  font-family: monospace;
  font-size: 0.8125em;
  color: var(--var-v2-primary);
  word-break: break-all;
  line-height: 1.4;
}

/* 正则说明内容 */
.regex-help-content {
  font-size: 0.875em;
  line-height: 1.6;
}

.regex-help-content h4 {
  display: flex;
  align-items: center;
  gap: 6px;
  margin: 12px 0 8px 0;
  font-size: 0.9375em;
  color: var(--var-v2-text-primary);
}

.regex-help-content h4:first-child {
  margin-top: 0;
}

.regex-help-content h4 i {
  color: var(--var-v2-primary);
}

.regex-help-content p {
  margin: 0 0 8px 0;
  color: var(--var-v2-text-secondary);
}

.regex-help-content ul {
  margin: 0 0 8px 0;
  padding-left: 20px;
}

.regex-help-content li {
  margin-bottom: 4px;
  color: var(--var-v2-text-secondary);
}

.regex-help-content strong {
  color: var(--var-v2-text-primary);
}


/* ============================================
   19. 变量条目拖拽排序样式 (v2.1)
   ============================================ */

/* 条目拖拽手柄 */
.var-v2-entry-drag-handle {
  color: var(--var-v2-text-secondary);
  cursor: grab;
  padding: 4px;
  opacity: 0.4;
  transition: opacity 0.15s;
  font-size: 0.75em;
}

.var-v2-entry:hover .var-v2-entry-drag-handle {
  opacity: 0.8;
}

.var-v2-entry-drag-handle:active {
  cursor: grabbing;
}

/* 条目拖拽状态 */
.var-v2-entry.dragging {
  opacity: 0.5;
  background: var(--var-v2-primary-light);
}

.var-v2-entry.drag-over-top {
  box-shadow: inset 0 3px 0 var(--var-v2-primary);
}

.var-v2-entry.drag-over-bottom {
  box-shadow: inset 0 -3px 0 var(--var-v2-primary);
}

/* 条目标题调整（显示序号而非ID） */
.var-v2-entry-title {
  flex: 1;
}


/* ============================================
   20. 三标签页布局 + 底部发送栏 (v2.2)
   ============================================ */

/* 标签页内容包装器（可滚动区域） */
.var-v2-tab-content-wrapper {
  flex: 1;
  overflow-y: auto;
  min-height: 0;
}

/* 主页面布局调整 */
#var-v2-page-main {
  display: flex;
  flex-direction: column;
  height: 100%;
}

/* 标签页样式调整（三个标签） */
.var-v2-tabs {
  display: flex;
  gap: 0;
  flex-shrink: 0;
}

.var-v2-tab {
  flex: 1;
  text-align: center;
  padding: 10px 8px;
  font-size: 0.8125em;
  color: var(--var-v2-text-secondary);
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: all 0.15s;
  background: var(--var-v2-bg-white);
}

.var-v2-tab:hover {
  color: var(--var-v2-text-primary);
  background: var(--var-v2-bg-main);
}

.var-v2-tab.active {
  color: var(--var-v2-primary);
  border-bottom-color: var(--var-v2-primary);
  font-weight: 500;
}

/* 全屏预览区（发送预览/返回预览） */
.var-v2-preview-full {
  display: flex;
  flex-direction: column;
  height: 100%;
  padding: 8px;
  gap: 8px;
}

.var-v2-preview-full-content {
  flex: 1;
  padding: 12px;
  font-size: 0.8125em;
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.6;
  color: var(--var-v2-text-primary);
  background: var(--var-v2-bg-white);
  border-radius: 8px;
  overflow-y: auto;
}

.var-v2-preview-full-textarea {
  flex: 1;
  width: 100%;
  padding: 12px;
  font-size: 0.8125em;
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.6;
  color: var(--var-v2-text-primary);
  background: var(--var-v2-bg-white);
  border: 1px solid var(--var-v2-border);
  border-radius: 8px;
  resize: none;
  font-family: inherit;
}

.var-v2-preview-full-textarea:focus {
  outline: none;
  border-color: var(--var-v2-primary);
}

.var-v2-preview-actions {
  display: flex;
  justify-content: flex-end;
  flex-shrink: 0;
}

/* 底部固定发送栏 */
.var-v2-send-bar {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  background: var(--var-v2-bg-white);
  border-top: 1px solid var(--var-v2-border);
  flex-shrink: 0;
}

.var-v2-send-status {
  flex: 1;
  font-size: 0.75em;
  color: var(--var-v2-text-secondary);
}

.var-v2-send-status .status-text {
  display: flex;
  align-items: center;
  gap: 6px;
}

.var-v2-send-status.analyzing {
  color: var(--var-v2-primary);
}

.var-v2-send-status.terminated {
  color: var(--var-v2-danger);
}

.var-v2-send-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 16px;
  background: var(--var-v2-primary);
  color: var(--var-v2-text-white);
  border: none;
  border-radius: 6px;
  font-size: 0.8125em;
  cursor: pointer;
  transition: all 0.15s;
  white-space: nowrap;
}

.var-v2-send-btn:hover {
  background: var(--var-v2-primary-dark);
}

.var-v2-send-btn:active {
  transform: scale(0.98);
}

.var-v2-send-btn.analyzing {
  background: var(--var-v2-danger);
}

.var-v2-send-btn.analyzing:hover {
  background: var(--preferred);
}

/* 队列按钮徽章 */
.var-v2-header-btn {
  position: relative;
}

.var-v2-queue-badge {
  position: absolute;
  top: -4px;
  right: -4px;
  min-width: 16px;
  height: 16px;
  padding: 0 4px;
  background: var(--var-v2-danger);
  color: var(--var-v2-text-white);
  font-size: 0.625em;
  font-weight: 600;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.var-v2-queue-badge.hidden {
  display: none;
}

/* 队列弹窗内容 */
.var-v2-queue-content {
  min-height: 200px;
}

.var-v2-queue-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  color: var(--var-v2-text-secondary);
  text-align: center;
}

.var-v2-queue-empty i {
  font-size: 2em;
  margin-bottom: 12px;
  opacity: 0.5;
}

.var-v2-queue-empty p {
  margin: 0 0 4px 0;
  font-size: 0.9375em;
}

.var-v2-queue-empty small {
  font-size: 0.75em;
  opacity: 0.7;
}

/* 隐藏旧的 FAB 按钮（已移到底部发送栏） */
.var-v2-fab {
  display: none !important;
}


/* ============================================
   21. 队列弹窗样式 (v2.2)
   ============================================ */

/* 队列设置区 */
.var-v2-queue-settings {
  padding: 12px;
  background: var(--var-v2-bg-main);
  border-radius: 8px;
  margin-bottom: 12px;
}

.var-v2-queue-setting-item {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  font-size: 0.875em;
}

.var-v2-queue-setting-item input[type="checkbox"] {
  width: 16px;
  height: 16px;
  cursor: pointer;
  accent-color: var(--var-v2-primary);
}

.var-v2-queue-hint {
  display: block;
  font-size: 0.75em;
  color: var(--var-v2-text-secondary);
  margin-top: 6px;
  padding-left: 24px;
}

/* 队列列表 */
.var-v2-queue-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
  max-height: 300px;
  overflow-y: auto;
}

/* 队列任务项 */
.var-v2-queue-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 12px;
  background: var(--var-v2-bg-white);
  border-radius: 8px;
  gap: 12px;
}

.var-v2-queue-item-info {
  display: flex;
  flex-direction: column;
  gap: 4px;
  flex: 1;
  min-width: 0;
}

.var-v2-queue-item-name {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.875em;
  font-weight: 500;
  color: var(--var-v2-text-primary);
}

.var-v2-queue-item-name i {
  color: var(--var-v2-text-secondary);
  font-size: 0.875em;
}

.var-v2-queue-item-status {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 0.75em;
  color: var(--var-v2-text-secondary);
}

.var-v2-queue-item-status.pending {
  color: var(--var-v2-text-secondary);
}

.var-v2-queue-item-status.processing {
  color: var(--var-v2-primary);
}

.var-v2-queue-item-status.paused {
  color: var(--SmartThemeQuoteColor);
}

.var-v2-queue-item-snapshot {
  font-size: 0.6875em;
  color: var(--var-v2-text-secondary);
  opacity: 0.7;
}

/* 队列任务操作按钮 */
.var-v2-queue-item-actions {
  display: flex;
  gap: 6px;
  flex-shrink: 0;
}

.var-v2-queue-action {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--var-v2-bg-main);
  border: none;
  border-radius: 6px;
  color: var(--var-v2-text-secondary);
  cursor: pointer;
  transition: all 0.15s;
  font-size: 0.75em;
}

.var-v2-queue-action:hover {
  background: var(--var-v2-primary-light);
  color: var(--var-v2-primary);
}

.var-v2-queue-action.danger:hover {
  background: color-mix(in srgb, var(--preferred) 10%, transparent);
  color: var(--var-v2-danger);
}

/* 危险按钮样式（清空队列） */
.var-v2-btn-danger {
  background: var(--var-v2-danger) !important;
  color: var(--var-v2-text-white) !important;
  border-color: var(--var-v2-danger) !important;
}

.var-v2-btn-danger:hover {
  opacity: 0.9;
}


/* 发送栏 pending 状态（队列中等待） */
.var-v2-send-status.pending {
  color: var(--SmartThemeQuoteColor);
}

.var-v2-send-btn.pending {
  background: var(--SmartThemeQuoteColor);
}

.var-v2-send-btn.pending:hover {
  background: var(--SmartThemeQuoteColor);
}

/* 发送栏 paused 状态（已暂停） */
.var-v2-send-status.paused {
  color: var(--var-v2-text-secondary);
}


/* 触发计数信息 */
.var-v2-count-info {
  font-size: 0.75em;
  color: var(--var-v2-text-secondary);
  opacity: 0.8;
}


/* ============================================
   22. 教程弹窗样式 (v2.3)
   ============================================ */

/* 标签页导航 */
.var-v2-help-tabs {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  padding: 8px 12px;
  background: var(--var-v2-bg-main);
  border-bottom: 1px solid var(--var-v2-border);
}

.var-v2-help-tab {
  padding: 6px 12px;
  font-size: 0.8125em;
  color: var(--var-v2-text-secondary);
  background: transparent;
  border: none;
  border-radius: 16px;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
}

.var-v2-help-tab:hover {
  color: var(--var-v2-primary);
  background: color-mix(in srgb, var(--SmartThemeQuoteColor) 10%, transparent);
}

.var-v2-help-tab.active {
  color: var(--SmartThemeBodyColor);
  background: var(--var-v2-primary);
}

/* 标签页内容容器 */
.var-v2-help-pages {
  flex: 1;
  overflow-y: auto;
  padding: 12px 16px;
}

/* 单个标签页 */
.var-v2-help-page {
  display: none;
}

.var-v2-help-page.active {
  display: block;
}

/* 教程内容样式 */
.var-v2-help-content {
  padding: 8px 0;
  max-height: 60vh;
  overflow-y: auto;
  font-size: 0.875em;
  line-height: 1.6;
}

.var-v2-help-content h3 {
  font-size: 1em;
  font-weight: 600;
  color: var(--var-v2-text-primary);
  margin: 16px 0 8px 0;
  padding-bottom: 6px;
  border-bottom: 1px solid var(--var-v2-border);
}

.var-v2-help-content h3:first-child {
  margin-top: 0;
}

.var-v2-help-content h3 i {
  margin-right: 6px;
  color: var(--var-v2-primary);
}

.var-v2-help-content h4 {
  font-size: 0.9375em;
  font-weight: 600;
  color: var(--var-v2-text-primary);
  margin: 16px 0 8px 0;
}

.var-v2-help-content p {
  margin: 8px 0;
  color: var(--var-v2-text-primary);
}

.var-v2-help-content ul,
.var-v2-help-content ol {
  margin: 8px 0;
  padding-left: 20px;
}

.var-v2-help-content li {
  margin: 6px 0;
}

/* 帮助卡片 */
.help-card {
  background: var(--var-v2-bg-white);
  border-radius: 8px;
  margin: 12px 0;
  overflow: hidden;
  border: 1px solid var(--var-v2-border);
}

.help-card-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 12px;
  background: var(--var-v2-bg-main);
  border-bottom: 1px solid var(--var-v2-border);
  font-size: 0.875em;
}

.help-card-header i {
  color: var(--var-v2-primary);
}

.help-card-body {
  padding: 12px;
  font-size: 0.875em;
  line-height: 1.6;
}

.help-card-body p {
  margin: 6px 0;
}

.help-card-body ul {
  margin: 8px 0;
  padding-left: 18px;
}

.help-card-body li {
  margin: 4px 0;
}

/* 叠加/覆盖卡片特殊样式 */
.help-card.stack .help-card-header {
  border-left: 3px solid var(--var-v2-success);
}

.help-card.replace .help-card-header {
  border-left: 3px solid var(--var-v2-warning);
}

/* 教程表格 */
.var-v2-help-table {
  width: 100%;
  border-collapse: collapse;
  margin: 8px 0;
  font-size: 0.8125em;
}

.var-v2-help-table th,
.var-v2-help-table td {
  padding: 8px 10px;
  text-align: left;
  border-bottom: 1px solid var(--var-v2-border);
}

.var-v2-help-table th {
  width: 140px;
  color: var(--var-v2-text-primary);
  font-weight: 500;
  background: var(--var-v2-bg-main);
}

.var-v2-help-table td {
  color: var(--var-v2-text-secondary);
}

.var-v2-help-table th i {
  margin-right: 6px;
  color: var(--var-v2-primary);
}

.var-v2-help-table code {
  display: inline-block;
  padding: 2px 6px;
  background: var(--var-v2-bg-main);
  border-radius: 4px;
  font-family: 'SF Mono', Consolas, monospace;
  font-size: 0.9em;
  color: var(--var-v2-primary);
  margin: 2px 0;
}

/* 警告框 */
.var-v2-help-warning {
  display: flex;
  gap: 12px;
  padding: 12px;
  background: color-mix(in srgb, var(--SmartThemeQuoteColor) 10%, transparent);
  border: 1px solid var(--SmartThemeQuoteColor);
  border-radius: 8px;
  margin: 12px 0;
}

.var-v2-help-warning i {
  font-size: 1.25em;
  color: var(--SmartThemeQuoteColor);
  flex-shrink: 0;
}

.var-v2-help-warning p {
  margin: 4px 0;
  color: var(--SmartThemeEmColor);
}

.var-v2-help-warning strong {
  color: var(--SmartThemeQuoteColor);
}

/* 提示框 */
.var-v2-help-tip {
  display: flex;
  gap: 12px;
  padding: 12px;
  background: color-mix(in srgb, var(--SmartThemeUnderlineColor) 10%, transparent);
  border: 1px solid var(--SmartThemeUnderlineColor);
  border-radius: 8px;
  margin: 12px 0;
}

.var-v2-help-tip i {
  font-size: 1.25em;
  color: var(--var-v2-primary);
  flex-shrink: 0;
}

.var-v2-help-tip p {
  margin: 4px 0;
  color: var(--SmartThemeEmColor);
}

.var-v2-help-tip ul {
  margin: 8px 0;
  padding-left: 18px;
}

/* 步骤列表样式 */
.var-v2-help-steps {
  counter-reset: step;
  margin: 12px 0;
}

.var-v2-help-steps .step {
  display: flex;
  gap: 12px;
  margin: 12px 0;
  padding: 10px;
  background: var(--var-v2-bg-main);
  border-radius: 8px;
}

.var-v2-help-steps .step-num {
  width: 24px;
  height: 24px;
  background: var(--var-v2-primary);
  color: var(--SmartThemeBodyColor);
  border-radius: 50%;
  font-size: 0.75em;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.var-v2-help-steps .step-content strong {
  display: block;
  font-size: 0.875em;
  color: var(--var-v2-text-primary);
  margin-bottom: 4px;
}

.var-v2-help-steps .step-content p {
  margin: 0;
  font-size: 0.8125em;
  color: var(--var-v2-text-secondary);
}

.var-v2-help-content code {
  display: inline-block;
  padding: 4px 8px;
  background: var(--var-v2-bg-main);
  border-radius: 4px;
  font-family: 'SF Mono', Consolas, monospace;
  font-size: 0.875em;
  color: var(--var-v2-primary);
  margin: 4px 0;
}

/* 状态点样式 */
.status-dot {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  margin-right: 6px;
}

.status-dot.pending {
  background: var(--var-v2-text-secondary);
}

.status-dot.processing {
  background: var(--var-v2-primary);
  animation: pulse 1.5s infinite;
}

.status-dot.paused {
  background: var(--var-v2-warning);
}

@keyframes pulse {

  0%,
  100% {
    opacity: 1;
  }

  50% {
    opacity: 0.5;
  }
}